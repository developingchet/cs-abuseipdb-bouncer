# ==============================================================================
# CrowdSec AbuseIPDB Bouncer - Environment Configuration (v2.0)
# ==============================================================================
#
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#   chmod 600 .env
#
# Required variables must be set. Optional variables have sensible defaults.

# ------------------------------------------------------------------------------
# Required: CrowdSec LAPI connection
# ------------------------------------------------------------------------------
# URL of the CrowdSec Local API. Use the service name for Docker networks,
# or a hostname/IP for a remote LAPI.
# Examples:
#   http://crowdsec:8080           (same Docker network, no TLS)
#   https://crowdsec.local:8443    (TLS-enabled)
CROWDSEC_LAPI_URL=http://crowdsec:8080

# Bouncer API key from:
#   docker exec crowdsec cscli bouncers add abuseipdb-bouncer
# You will only see this key once -- copy it immediately.
CROWDSEC_LAPI_KEY=

# ------------------------------------------------------------------------------
# Required: AbuseIPDB API key
# ------------------------------------------------------------------------------
# Get your v2 API key from: https://www.abuseipdb.com/account/api
# Free tier: 1000 reports/day, 1000 checks/day
ABUSEIPDB_API_KEY=

# ------------------------------------------------------------------------------
# Optional: Daily report quota
# ------------------------------------------------------------------------------
# Maximum reports to send per UTC day. Counter resets at midnight UTC.
# Match this to your AbuseIPDB subscription tier:
#   Free=1000, Webmaster=3000, Premium=50000
# Default: 1000
#ABUSEIPDB_DAILY_LIMIT=1000

# ------------------------------------------------------------------------------
# Optional: Pre-check before reporting
# ------------------------------------------------------------------------------
# Call /check before /report to skip whitelisted IPs.
# Each call consumes one /check quota unit. Disable on the free tier if you
# want to preserve all 1000 checks for other uses.
# Default: false
#ABUSEIPDB_PRECHECK=false

# ------------------------------------------------------------------------------
# Optional: Minimum decision duration filter
# ------------------------------------------------------------------------------
# Skip decisions shorter than this duration.
# Accepts Go duration strings ("5m", "300s") or plain integers (seconds, v1 compat).
# Useful for filtering test or simulation decisions (e.g., 5-minute bans).
# Default: 0 (disabled)
#ABUSEIPDB_MIN_DURATION=0

# ------------------------------------------------------------------------------
# Optional: Per-IP cooldown window
# ------------------------------------------------------------------------------
# Suppresses duplicate reports for the same IP within this window.
# AbuseIPDB deduplicates reports within 15 minutes, so reports within this
# window return HTTP 422 and waste quota. The default matches that window.
# Minimum: 1m
# Default: 15m
#COOLDOWN_DURATION=15m

# ------------------------------------------------------------------------------
# Optional: LAPI polling interval
# ------------------------------------------------------------------------------
# How often to poll the LAPI for new decisions. Minimum: 10s
# Default: 30s
#POLL_INTERVAL=30s

# ------------------------------------------------------------------------------
# Optional: TLS verification
# ------------------------------------------------------------------------------
# Set to true only if your CrowdSec LAPI uses a self-signed certificate.
# Do not set to true in production unless necessary.
# Default: false
#TLS_SKIP_VERIFY=false

# ------------------------------------------------------------------------------
# Optional: Logging
# ------------------------------------------------------------------------------
# Log level: trace, debug, info, warn, error
# Default: info
LOG_LEVEL=info

# Log format: json (structured, for SIEM/log aggregators) or text (human-readable)
# Default: json
#LOG_FORMAT=json

# ------------------------------------------------------------------------------
# Optional: Persistent state directory (v2.0 — was STATE_DIR in v1)
# ------------------------------------------------------------------------------
# Directory where state.db (bbolt) is stored. Must be writable.
# Mount a named Docker volume here for persistence across restarts.
# Default: /data
#DATA_DIR=/data

# ------------------------------------------------------------------------------
# Optional: Metrics / health probe HTTP server
# ------------------------------------------------------------------------------
# Address to listen on for Prometheus metrics and Kubernetes probes.
#   GET /metrics  → Prometheus metrics
#   GET /healthz  → liveness probe (always 200 "ok")
#   GET /readyz   → readiness probe (200 or 503)
# Set to empty string to disable the server entirely.
# Default: :9090
#METRICS_ADDR=:9090

# ------------------------------------------------------------------------------
# Optional: YAML configuration file
# ------------------------------------------------------------------------------
# Path to an optional YAML config file. Environment variables always take
# precedence over file values.
# Default: (unset — env-only mode)
#CONFIG_FILE=/etc/cs-abuseipdb/config.yaml
