# Path to the reporter script inside the container
bin_path: /abuseipdb-reporter.sh

# Arguments passed to the script (none - env vars are used instead)
bin_args: []

# Feed decisions to the script via stdin (one JSON object per line)
feed_via_stdin: true

# Infinite retries if the script exits (-1 = infinite)
total_retries: -1

# Only report single IPs (not ranges, ASNs, or countries)
scopes:
  - Ip

# Only report decisions from local detections (not CAPI/community blocklist)
origins:
  - crowdsec  # Local scenario detections
  - cscli     # Manual decisions via CLI

# Bouncer-level cache prevents duplicate script invocations within 15 minutes
cache_retention_duration: 15m

# Poll LAPI every 30 seconds for new decisions
update_frequency: 30s

# Log to stdout (captured by docker logs)
log_mode: stdout
log_level: info

# CrowdSec LAPI connection
# Update api_url to your LAPI address (e.g., https://crowdsec.local:8443)
api_url: https://YOUR_LAPI_HOST:8443

# API key placeholder - replaced by entrypoint script with $CROWDSEC_ABUSEIPDB_BOUNCER_KEY
api_key: __CROWDSEC_ABUSEIPDB_BOUNCER_KEY__

# Uncomment if using self-signed certificate
# insecure_skip_verify: true
